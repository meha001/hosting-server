{% extends "base.html" %}
{% block title %} Dashboard {% endblock %}

{% block content %}
<div class="dashboard-container">
  <h1 class="dashboard-title">
    <i class="fas fa-rocket"></i> Your frontend hosting. Simple and fast.
  </h1>

  <div class="user-apps">
    {% if not current_user.apps %}
      <div class="empty-card">
        <h3><i class="fas fa-box-open"></i> You don't have an application</h3>
        <p>Create your first app and publish it in seconds.</p>
        <a href="{{ url_for('apps.index') }}" class="btn btn-success">
          <i class="fas fa-plus"></i> Create a new app
        </a>
      </div>
    {% else %}
      <div class="apps-grid">
        {% for app in current_user.apps %}
          <div class="app-card">
            <div class="app-card-head">
              <h4 class="app-name">
                <a href="{{ url_for('apps.manage_app', app_id=app.app_id) }}">
                  <i class="fas fa-layer-group"></i> {{ app.app_name }}
                </a>
              </h4>
              <div class="app-actions">
                <a class="btn btn-small" href="{{ url_for('files.serve_site', site_id=app.app_id) }}" target="_blank">
                  <i class="fas fa-external-link-alt"></i> Open
                </a>
                <a class="btn btn-success" href="{{ url_for('apps.manage_app', app_id=app.app_id) }}">
                  <i class="fas fa-cogs"></i> Manage
                </a>
              </div>
            </div>

            <p class="app-link">
              <i class="fas fa-link"></i>
              <a href="{{ url_for('files.serve_site', site_id=app.app_id) }}" target="_blank">
                /sites/{{ app.app_id }}
              </a>
            </p>

            <p class="app-meta">
              <i class="fas fa-file-alt"></i> Files:
              <strong>{{ app.get_files()|length }}</strong>
              Â· <i class="fas fa-calendar-alt"></i> Created:
              <strong>{{ app.created_at.strftime("%Y-%m-%d") if app.created_at else '-' }}</strong>
            </p>
          </div>
        {% endfor %}
      </div>

      {% if apps|length < 5 %}
        <div class="controls" style="margin-top:16px;">
          <a href="{{ url_for('apps.index') }}" class="btn btn-success">
            <i class="fas fa-plus"></i> Create a new app
          </a>
        </div>
      {% else %}
        <p class="text-danger" style="margin-top:16px;">
          ðŸš« You already have 5 applications (limit reached).
        </p>
      {% endif %}


      <!-- <div class="controls" style="margin-top:16px;">
        <a href="{{ url_for('apps.index') }}" class="btn btn-success">
          <i class="fas fa-plus"></i> Create a new app
        </a>
      </div> -->
    {% endif %}
  </div>
</div>
{% endblock %}
